(()=>{const t=document.createElement("style");t.setAttribute("id","md-style-dm"),t.innerHTML=".md-customDM-container,.md-customDM-rpl,.md-customDM>article{transform:rotate(180deg)}.md-customDM>article{border:none!important;margin:6px 0!important}.md-customDM>article .tweet,.md-customDM>article .tweet>div,.md-customDM>article .tweet>header{transform:rotate(180deg)}.md-customDM>article .tweet{padding-left:0;padding-right:46px}.md-customDM>article .tweet>header{margin-bottom:1px}.md-customDM>article .tweet>header>time{position:absolute;top:-3px;left:0}.md-customDM>article .tweet>header>a{display:inline-block!important;color:#a0abb3}.md-customDM>article .tweet>header>a>div{bottom:55px}.md-customDM>article .tweet>header .username{display:none}.md-customDM>article .tweet>header>a>div.nbfc{display:none}.md-customDM>article .tweet>div.tweet-body{width:80%;margin-left:20%}.md-customDM>article .tweet>div.tweet-body>*{display:inline-block}.md-customDM>article .tweet>div.tweet-body>.tweet-text{width:auto!important;max-width:100%;padding:8px 10px;box-sizing:border-box}.md-customDM>article .tweet>div.tweet-body>.media-preview{width:100%;margin:0!important}.md-customDM>article .tweet>div.tweet-body>.media-preview>div{margin:0!important}.md-customDM>article .tweet>div.tweet-body>footer{position:absolute;bottom:0;margin-left:6px}.js-detail-container>div:not(.js-detail-content)>.rpl{padding-bottom:50px}.md-customDM>article.md-myMsg{transform:scale(1,-1)}.md-customDM>article.md-myMsg .dropdown-menu,.md-customDM>article.md-myMsg .tweet>div.tweet-body>:not(footer),.md-customDM>article.md-myMsg .tweet>header>a>div.item-img,.md-customDM>article.md-myMsg .tweet>header>a>div.nbfc>span,.md-customDM>article.md-myMsg .tweet>header>time{transform:scale(-1,1)}.md-customDM>article.md-myMsg .tweet{padding-right:0}.md-customDM>article.md-myMsg .tweet>header .tweet-avatar{display:none}.md-customDM>article.md-myMsg .tweet>div.tweet-body>.tweet-text a{text-decoration:underline}.md-customDM>article .tweet>div.tweet-body>.quoted-tweet{border-color:#1da1f2!important;width:100%;margin:0!important;box-sizing:border-box}html .md-customDM>article .tweet>div.tweet-body>.tweet-text.md-emojionly,html.dark .md-customDM>article .tweet>div.tweet-body>.tweet-text.md-emojionly{margin:0 0 2px 0!important;padding:0!important;overflow:visible!important;background-color:#0000!important}.md-customDM>article .tweet>div.tweet-body>.tweet-text.md-emojionly>*{width:2.2em!important;height:2.2em!important}.md-customDM .tweet-timestamp{padding-left:0!important}.md-customDM>article .tweet>div.tweet-body>.media-preview .media-item,.md-customDM>article .tweet>div.tweet-body>.quoted-tweet,.md-customDM>article .tweet>div.tweet-body>.tweet-text{border-radius:16px 16px 16px 0!important}.md-customDM>article.md-myMsg .tweet>div.tweet-body>.media-preview .media-item,.md-customDM>article.md-myMsg .tweet>div.tweet-body>.quoted-tweet,.md-customDM>article.md-myMsg .tweet>div.tweet-body>.tweet-text{border-radius:16px 16px 0 16px!important}.md-customDM>article.md-imgWithText .tweet>div.tweet-body>.tweet-text,.md-customDM>article.md-quotedWithText .tweet>div.tweet-body>.tweet-text{border-radius:0 0 16px 0!important}.md-customDM>article.md-imgWithText .tweet>div.tweet-body>.media-preview .media-item,.md-customDM>article.md-quotedWithText .tweet>div.tweet-body>.quoted-tweet{border-radius:16px 16px 0 0!important}.md-customDM>article.md-myMsg.md-imgWithText .tweet>div.tweet-body>.tweet-text,.md-customDM>article.md-myMsg.md-quotedWithText .tweet>div.tweet-body>.tweet-text{border-radius:0 0 0 16px!important}.md-customDM>article.md-imgWithText .tweet>div.tweet-body>.tweet-text,.md-customDM>article.md-quotedWithText .tweet>div.tweet-body>.tweet-text{width:100%!important;margin-top:-5px!important}.md-customDM>article .tweet>div.tweet-body>footer{display:none}.md-customDM>article[md-onajiuser=bottom] .tweet>header,.md-customDM>article[md-onajiuser=top] .tweet>header{background-color:#6d0000!important;display:none}html .md-customDM>article[md-onajiuser=top],html.dark .md-customDM>article[md-onajiuser=top]{margin:-1px 0 6px!important}html .md-customDM>article[md-onajiuser=top]>div,html.dark .md-customDM>article[md-onajiuser=top]>div{padding:8px 10px 0!important}html .md-customDM>article[md-onajiuser=bottom],html.dark .md-customDM>article[md-onajiuser=bottom]{margin:-1px 0 0!important}html .md-customDM>article[md-onajiuser=bottom]>div,html.dark .md-customDM>article[md-onajiuser=bottom]>div{padding:0 10px!important}html .md-customDM>article[md-onajiuser='bottom last'],html.dark .md-customDM>article[md-onajiuser='bottom last']{margin:6px 0 -1px!important}html .md-customDM>article[md-onajiuser='bottom last']>div,html.dark .md-customDM>article[md-onajiuser='bottom last']>div{padding:0 10px 8px!important}.md-customDM>article[md-onajiuser~=bottom] .tweet>div.tweet-body>.media-preview .media-item,.md-customDM>article[md-onajiuser~=bottom] .tweet>div.tweet-body>.quoted-tweet,.md-customDM>article[md-onajiuser~=bottom] .tweet>div.tweet-body>.tweet-text{border-radius:0 16px 16px 0!important}.md-customDM>article[md-onajiuser~=bottom].md-myMsg .tweet>div.tweet-body>.media-preview .media-item,.md-customDM>article[md-onajiuser~=bottom].md-myMsg .tweet>div.tweet-body>.quoted-tweet,.md-customDM>article[md-onajiuser~=bottom].md-myMsg .tweet>div.tweet-body>.tweet-text{border-radius:16px 0 0 16px!important}html .md-customDM>article[md-onajiuser] .tweet>div.tweet-body>.tweet-text.md-emojionly{margin-bottom:10px!important}.md-customDM>article[md-onajiuser~=bottom].md-imgWithText .tweet>div.tweet-body>.media-preview .media-item,.md-customDM>article[md-onajiuser~=bottom].md-quotedWithText .tweet>div.tweet-body>.quoted-tweet{border-radius:0 16px 0 0!important}.md-customDM>article[md-onajiuser~=bottom].md-imgWithText .tweet>div.tweet-body>.tweet-text,.md-customDM>article[md-onajiuser~=bottom].md-quotedWithText .tweet>div.tweet-body>.tweet-text{border-radius:0 0 16px 0!important}.md-customDM>article[md-onajiuser~=bottom].md-myMsg.md-imgWithText .tweet>div.tweet-body>.media-preview .media-item,.md-customDM>article[md-onajiuser~=bottom].md-myMsg.md-quotedWithText .tweet>div.tweet-body>.quoted-tweet{border-radius:16px 0 0 0!important}.md-customDM>article[md-onajiuser~=bottom].md-myMsg.md-imgWithText .tweet>div.tweet-body>.tweet-text,.md-customDM>article[md-onajiuser~=bottom].md-myMsg.md-quotedWithText .tweet>div.tweet-body>.tweet-text{border-radius:0 0 0 16px!important}html .js-message-detail.md-customDM>article,html.dark .js-message-detail.md-customDM>article{background-color:#0000!important}html .md-customDM>article .tweet>.tweet-body>.tweet-text{background-color:#ebeef0;color:#0f1419}html.dark .md-customDM>article .tweet>.tweet-body>.tweet-text{background-color:#3d5466;color:#fff}html .md-customDM>article.md-myMsg .tweet>.tweet-body>.tweet-text{background-color:#1da1f2;color:#fff}html.dark .md-customDM>article.md-myMsg .tweet>.tweet-body>.tweet-text{background-color:#1da1f2;color:#fff}html .md-customDM>article .tweet>.tweet-body>.quoted-tweet{border-color:#ebeef0!important}html.dark .md-customDM>article .tweet>.tweet-body>.quoted-tweet{border-color:#3d5466!important}html .md-customDM>article.md-myMsg .tweet>.tweet-body>.quoted-tweet{border-color:#1da1f2!important}html.dark .md-customDM>article.md-myMsg .tweet>.tweet-body>.quoted-tweet{border-color:#1da1f2!important}html .md-customDM>article.md-myMsg .tweet>.tweet-body>.tweet-text>a{color:#fff}html.dark .md-customDM>article.md-myMsg .tweet>.tweet-body>.tweet-text>a{color:#fff}",document.head.appendChild(t);let e=null,o=null,d={childList:!0,characterData:!0};let m=null,i=0;function r(){m=setInterval(function(){i>7&&clearInterval(m),(o=document.body.querySelector(`section.column[data-column="${n}"] div.js-message-detail`))&&((e=new MutationObserver(function(t){e.disconnect(),l(),e.observe(o,d)})).observe(o,d),m&&clearInterval(m)),i++},100)}function a(t,e){if(isNaN(t)||isNaN(e))return;const o=new Date(t),d=new Date(e);return Math.floor((o.getTime()-d.getTime())/1e3)}let c=null,s=null;function l(){s&&clearTimeout(s),s=setTimeout(function(){try{const t=document.body.querySelector(`section.column[data-column="${n}"]`),e=t.querySelectorAll("div.js-message-detail > article[data-account-key]");e.length;let o=[],d=[];const m=t.querySelector("div.rpl > textarea").getAttribute("placeholder").match(/([@]\w+)/)[0];let i=null,r=null,s=null;for(let t=0;t<e.length;t++){const c=e.length-t-1,l=e[c].querySelector(".tweet > header time.tweet-timestamp");let n=null;l&&(n=Number(l.getAttribute("data-time")),d.push(n));const u=e[c].querySelector(".tweet > header span.username");let w=null;if(u&&(w=u.textContent,o.push(w)),n&&w)if(i==w)if(a(n,s=d[t-1])<=60){if(r||(r=t-1),r){1==t-r?(e[c+1].setAttribute("md-onajiuser","top"),e[c].setAttribute("md-onajiuser","bottom")):e[c].setAttribute("md-onajiuser","bottom")}}else r&&e[c+1].setAttribute("md-onajiuser","bottom last"),e[c].removeAttribute("md-onajiuser"),i=w,r=null;else r&&e[c+1].setAttribute("md-onajiuser","bottom last"),e[c].removeAttribute("md-onajiuser"),i=w,r=null;if(e[c].classList.contains("md-dmChanged"))continue;w==m&&u.closest("article.stream-item").classList.add("md-myMsg");const b=e[c].querySelector(".tweet-body > .tweet-text");b&&""==b.textContent&&(b.hasChildNodes()?b.classList.add("md-emojionly"):b.style.display="none");const p=e[c].querySelector(".tweet-body > .media-preview");if(p&&b){const t=p.getAttribute("data-key");try{if(b.querySelector(`a[data-full-url*="https://twitter.com/messages/media/${t}"]`).remove(),""==b.innerText)b.remove();else{p.closest(".tweet-body").insertBefore(p,b),e[c].classList.add("md-imgWithText")}}catch(t){}}const y=e[c].querySelector(".tweet-body > .quoted-tweet");if(y&&b.innerText){y.closest(".tweet-body").insertBefore(y,b),e[c].classList.add("md-quotedWithText")}e[c].classList.add("md-dmChanged")}r&&e[0].setAttribute("md-onajiuser","bottom last"),u&&(c&&clearTimeout(c),t.querySelector("div.js-detail-container > div").classList.add("md-customDM-container"),t.querySelector("div.js-detail-container > div > div.rpl").classList.add("md-customDM-rpl"),t.querySelector("div.js-detail-container > div > div.js-message-detail").classList.add("md-customDM"),c=setTimeout(function(){let e=null,o=setInterval(function(){try{const d=document.body.querySelector(`section.column[data-column="${n}"] div.js-detail-container`);d.scrollTo(0,d.scrollHeight);const m=t.querySelector("div.js-detail-container > div > div.rpl").getBoundingClientRect();(e=0<m.top&&m.bottom<window.innerHeight)&&o&&clearInterval(o)}catch(t){o&&clearInterval(o)}},100);u=!1},200))}catch(t){}},100)}let n=null,u=!0;document.body.addEventListener("click",function(t){if(document.getElementById("md-style-dm"))try{const o=t.target,d=o.closest("section.column");if("message"!=d.querySelector("header > i.column-type-icon").className.match(/\s*icon-(\w+)/)[1])return;n=d.getAttribute("data-column");const m=o.closest("a.js-column-back");m&&m.closest(`section.column[data-column="${n}"]`)?(e.disconnect(),e=null,u=!0):e||(l(),r())}catch(t){}else try{e.disconnect(),e=null}catch(t){}})})();
